import{W as g}from"./workbox-core-C1cRqoWm.js";try{self["workbox:routing:7.2.0"]&&_()}catch{}const R="GET",f=s=>s&&typeof s=="object"?s:{handle:s};class d{constructor(t,r,e=R){this.handler=f(r),this.match=t,this.method=e}setCatchHandler(t){this.catchHandler=f(t)}}class w extends d{constructor(t,r,e){const i=({url:a})=>{const n=t.exec(a.href);if(n&&!(a.origin!==location.origin&&n.index!==0))return n.slice(1)};super(i,r,e)}}class H{constructor(){this._routes=new Map,this._defaultHandlerMap=new Map}get routes(){return this._routes}addFetchListener(){self.addEventListener("fetch",t=>{const{request:r}=t,e=this.handleRequest({request:r,event:t});e&&t.respondWith(e)})}addCacheListener(){self.addEventListener("message",t=>{if(t.data&&t.data.type==="CACHE_URLS"){const{payload:r}=t.data,e=Promise.all(r.urlsToCache.map(i=>{typeof i=="string"&&(i=[i]);const a=new Request(...i);return this.handleRequest({request:a,event:t})}));t.waitUntil(e),t.ports&&t.ports[0]&&e.then(()=>t.ports[0].postMessage(!0))}})}handleRequest({request:t,event:r}){const e=new URL(t.url,location.href);if(!e.protocol.startsWith("http"))return;const i=e.origin===location.origin,{params:a,route:n}=this.findMatchingRoute({event:r,request:t,sameOrigin:i,url:e});let o=n&&n.handler;const c=t.method;if(!o&&this._defaultHandlerMap.has(c)&&(o=this._defaultHandlerMap.get(c)),!o)return;let h;try{h=o.handle({url:e,request:t,event:r,params:a})}catch(l){h=Promise.reject(l)}const m=n&&n.catchHandler;return h instanceof Promise&&(this._catchHandler||m)&&(h=h.catch(async l=>{if(m)try{return await m.handle({url:e,request:t,event:r,params:a})}catch(p){p instanceof Error&&(l=p)}if(this._catchHandler)return this._catchHandler.handle({url:e,request:t,event:r});throw l})),h}findMatchingRoute({url:t,sameOrigin:r,request:e,event:i}){const a=this._routes.get(e.method)||[];for(const n of a){let o;const c=n.match({url:t,sameOrigin:r,request:e,event:i});if(c)return o=c,(Array.isArray(o)&&o.length===0||c.constructor===Object&&Object.keys(c).length===0||typeof c=="boolean")&&(o=void 0),{route:n,params:o}}return{}}setDefaultHandler(t,r=R){this._defaultHandlerMap.set(r,f(t))}setCatchHandler(t){this._catchHandler=f(t)}registerRoute(t){this._routes.has(t.method)||this._routes.set(t.method,[]),this._routes.get(t.method).push(t)}unregisterRoute(t){if(!this._routes.has(t.method))throw new g("unregister-route-but-not-found-with-method",{method:t.method});const r=this._routes.get(t.method).indexOf(t);if(r>-1)this._routes.get(t.method).splice(r,1);else throw new g("unregister-route-route-not-registered")}}let u;const y=()=>(u||(u=new H,u.addFetchListener(),u.addCacheListener()),u);function M(s,t,r){let e;if(typeof s=="string"){const a=new URL(s,location.href),n=({url:o})=>o.href===a.href;e=new d(n,t,r)}else if(s instanceof RegExp)e=new w(s,t,r);else if(typeof s=="function")e=new d(s,t,r);else if(s instanceof d)e=s;else throw new g("unsupported-route-type",{moduleName:"workbox-routing",funcName:"registerRoute",paramName:"capture"});return y().registerRoute(e),e}export{d as R,M as r};
